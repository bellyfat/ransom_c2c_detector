# Ransom C2C Detector

Machine Learning Based Ransom C2C URL/Domain Detector.

**Ransom C2C Detector!** helps in finding the on-fly generated domains while ransomware infections:

* Easy to Generate New Model apt to requirements.
* Pluggable model to adapt to new variants of ransomwares.
* Uses n-gram technique to detect domains generated by ransomware.
* Support Algorthim Selector to choose algorthim to use based on the Efficasy.

## ▶️ Installation

### ▶️ Clone the Repo

```
% git clone git@github.com:uppusaikiran/ransom_c2c_detector.git
Cloning into 'ransom_c2c_detector'...
remote: Counting objects: 63, done.
remote: Compressing objects: 100% (52/52), done.
remote: Total 63 (delta 12), reused 51 (delta 6), pack-reused 0
Receiving objects: 100% (63/63), 23.16 MiB | 696.00 KiB/s, done.
Resolving deltas: 100% (12/12), done.
Checking connectivity... done.

```

### ▶️ Create a virutalenv

```
/tmp/dummy/ransom_c2c_detector
 % virtualenv venv
New python executable in /tmp/dummy/ransom_c2c_detector/venv/bin/python
Installing setuptools, pip, wheel...done.

```

### ▶️ Install the Required Packages

```
 % pip install -r requirements_dev.txt

```
### ▶️ Make the Model

* To make the model,navigate to the project root and run the script.As this creation of model takes long time,a generated model is already included.

```
/tmp/dummy/ransom_c2c_detector
 % cd ransom_c2c_detector
admin@root /tmp/dummy/ransom_c2c_detector/ransom_c2c_detector
 % ls
data.csv  __init__.py  model.plk  model.py  ransom_c2c_detector.py  utils
admin@root /tmp/dummy/ransom_c2c_detector/ransom_c2c_detector
 % python ransom_c2c_detector.py
 ```
### ▶️ Run the Predictor Script which helps in predicting unknown urls

```
 python model.py
INFO:__main__:URLModel:get_model()
Something wrong File not open for reading
INFO:__main__:RansomC2CDetector:create_corpus()
[2.663532754804255, 0.09151861261246144, 0.004186571949577747, 0.0002567613830879836, 0.0003830928361639637]
[*]Prediction for url gwbgmsmhgsp.com --> [1]
[2.75, 0.10122248604065265, 0.006589616361559483, 0.00019257103731598767, 0.0002873196271229728]
[*]Prediction for url facebook.com --> [0]
[2.1339375660949167, 0.10058688355294867, 0.004507770077122136, 0.0002781581650119822, 0.00041501723917762736]
[*]Prediction for url fklafkaaaassf.com --> [1]
[3.3232314287976203, 0.09591292856839724, 0.005411682974433002, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url puciftnfkplcbhp.net --> [1]
[3.3735572622751855, 0.09266339761338309, 0.005271302898258853, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url bowjjxxnhkyvygk.biz --> [1]
[3.5068905956085183, 0.09888045826589101, 0.0030378142068361643, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url osvwkptpwqyiqen.ru --> [1]
[3.640223928941852, 0.09015006751494577, 0.005937731371062851, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url cpmjpnwdgbxyyql.org --> [1]
[3.3735572622751855, 0.09234710330865999, 0.004987793673035381, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url ptlwqfsfvhxlaxw.co.uk --> [1]
[3.3735572622751855, 0.09396832544281, 0.002608515439458365, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url wwcdhdhijsfsuyr.info --> [1]
[3.240223928941852, 0.09064149258329363, 0.0024859599970877564, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url kbbqiudkyyffmeq.com --> [1]
[3.189898095464287, 0.09183726914608926, 0.0010277985362339775, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url xxrdnsgxijevnij.net --> [1]
[3.323231428797621, 0.09842381498176074, 0.003258183435700826, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url lcqqokcaxpeiowq.biz --> [1]
[3.4565647621309536, 0.09752592362946534, 0.004035195581902906, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url fhhvhiqlrtwpnik.ru --> [1]
[3.373557262275185, 0.09827483164842604, 0.003803209303146385, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url gwgweakshkaxnqv.org --> [1]
[3.6402239289418516, 0.10354928151178744, 0.005891174491725246, 0.00029955494693598085, 0.0005107904482186183]
[*]Prediction for url giwvnxpbqkvsnet.co.uk --> [1]
[3.3232314287976212, 0.08699136018850911, 0.00312622793769253, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url hxvwkpjigbybwyw.info --> [1]
[3.5068905956085192, 0.09834284754964771, 0.0049787483364783615, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url bpmpfnagtcdmuuk.com --> [1]
[3.5068905956085183, 0.09447294641055652, 0.005988544879368465, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url cflqcftnjsguukr.net --> [1]
[3.1395722619867232, 0.09655016017948378, 0.006025346983987714, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url cqcpldyvsscpnpk.biz --> [1]
[3.506890595608518, 0.09234832515119694, 0.0039192024425246455, 0.00034234851078397807, 0.0005107904482186183]
[*]Prediction for url dgbqiusdijfxwrj.ru --> [1]
[3.169925001442312, 0.09745807064058191, 0.001698306278465652, 0.0002139678192399863, 0.00031924403013663645]
[*]Prediction for url xjneysaum.us --> [0]
[2.1280852788913944, 0.08759649806895933, 0.0031128372923973327, 0.00017117425539198904, 0.00025539522410930913]
[*]Prediction for url hhbrghm.eu --> [0]

```
* Here 1 indicates the model predicted as C2C Generated By Ransomware and 0 indicates the model predicted as non-genereated by Ransomware.


Features
--------

* TODO

TODO
--------

* Write a brief in Readme explaining how model works.
* Show the detection Accuracy. 

